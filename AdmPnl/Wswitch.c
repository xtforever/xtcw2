/* Generated by wbuild
 * (generator version 3.3)
 */
#include <X11/IntrinsicP.h>
#include <X11/StringDefs.h>
#line 138 "Wswitch.widget"
#include "opts.h"
#line 139 "Wswitch.widget"
#include "mls.h"
#line 140 "Wswitch.widget"
#include "svar2.h"
#line 141 "Wswitch.widget"
#include <X11/Xft/Xft.h>
#line 142 "Wswitch.widget"
#include "converters-xft.h"
#line 143 "Wswitch.widget"
#include "converters.h"
#include <xtcw/WswitchP.h>
#line 64 "Wswitch.widget"
static void activate(
#if NeedFunctionPrototypes
Widget,XEvent*,String*,Cardinal*
#endif
);
#line 73 "Wswitch.widget"
static void deactivate(
#if NeedFunctionPrototypes
Widget,XEvent*,String*,Cardinal*
#endif
);
#line 82 "Wswitch.widget"
static void highlight(
#if NeedFunctionPrototypes
Widget,XEvent*,String*,Cardinal*
#endif
);
#line 89 "Wswitch.widget"
static void reset(
#if NeedFunctionPrototypes
Widget,XEvent*,String*,Cardinal*
#endif
);
#line 96 "Wswitch.widget"
static void toggle(
#if NeedFunctionPrototypes
Widget,XEvent*,String*,Cardinal*
#endif
);
#line 102 "Wswitch.widget"
static void notify(
#if NeedFunctionPrototypes
Widget,XEvent*,String*,Cardinal*
#endif
);

static XtActionsRec actionsList[] = {
{"activate", activate},
{"deactivate", deactivate},
{"highlight", highlight},
{"reset", reset},
{"toggle", toggle},
{"notify", notify},
};

static char defaultTranslations[] = "\
<EnterWindow>: highlight() \n\
<LeaveWindow>: reset() \n\
<BtnDown>: notify() \n\
";
static void _resolve_inheritance(
#if NeedFunctionPrototypes
WidgetClass
#endif
);
#line 19 "Wswitch.widget"
static void initialize(
#if NeedFunctionPrototypes
Widget ,Widget,ArgList ,Cardinal *
#endif
);
#line 31 "Wswitch.widget"
static int  exec_command(
#if NeedFunctionPrototypes
Widget,int ,int 
#endif
);
#line 42 "Wswitch.widget"
static XtGeometryResult  query_geometry(
#if NeedFunctionPrototypes
Widget,XtWidgetGeometry *,XtWidgetGeometry *
#endif
);
#line 111 "Wswitch.widget"
static void  init_svar(
#if NeedFunctionPrototypes
Widget
#endif
);
#line 120 "Wswitch.widget"
static void calculate_label_size(
#if NeedFunctionPrototypes
Widget,char *,int *,int *
#endif
);
#line 111 "Wswitch.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 111 "Wswitch.widget"
static void  init_svar(Widget self)
#else
#line 111 "Wswitch.widget"
static void  init_svar(self)Widget self;
#endif
#line 112 "Wswitch.widget"
{
	if( ((WswitchWidget)self)->wswitch.key_svar <= 0 ) return;
	int *v = svar_value(((WswitchWidget)self)->wswitch.key_svar);
	*v = append_mstring_array(*v,0, 
	     ((WswitchWidget)self)->wswitch.act ? ((WswitchWidget)self)->wswitch.value_on : ((WswitchWidget)self)->wswitch.value_off,
	     ((WswitchWidget)self)->wlabel.label, NULL );
}
#line 120 "Wswitch.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 120 "Wswitch.widget"
static void calculate_label_size(Widget self,char * s,int * w,int * h)
#else
#line 120 "Wswitch.widget"
static void calculate_label_size(self,s,w,h)Widget self;char * s;int * w;int * h;
#endif
#line 121 "Wswitch.widget"
{
	XGlyphInfo extents;
  	Display *dpy = XtDisplay(self);
    	XftTextExtentsUtf8(dpy, ((WswitchWidget)self)->wheel.xftFont, (FcChar8*)  s,
		       strlen( s ), &extents);

	*w = increase_by_percent( extents.xOff, ((WswitchWidget)self)->wlabel.leftOffsetPercent );

	if( *w < ((WswitchWidget)self)->wswitch.sizex ) {
	    *w = ((WswitchWidget)self)->wswitch.sizex;   	
        }

    	*h  = increase_by_percent( ((WswitchWidget)self)->wheel.xftFont->height, ((WswitchWidget)self)->wlabel.heightIncreasePercent);
}

static XtResource resources[] = {
#line 6 "Wswitch.widget"
{XtNvalue_off,XtCValue_off,XtRString,sizeof(((WswitchRec*)NULL)->wswitch.value_off),XtOffsetOf(WswitchRec,wswitch.value_off),XtRString,(XtPointer)"dummy"},
#line 7 "Wswitch.widget"
{XtNvalue_on,XtCValue_on,XtRString,sizeof(((WswitchRec*)NULL)->wswitch.value_on),XtOffsetOf(WswitchRec,wswitch.value_on),XtRString,(XtPointer)"dummy"},
#line 8 "Wswitch.widget"
{XtNlabel_off,XtCLabel_off,XtRString,sizeof(((WswitchRec*)NULL)->wswitch.label_off),XtOffsetOf(WswitchRec,wswitch.label_off),XtRString,(XtPointer)"dummy"},
#line 9 "Wswitch.widget"
{XtNlabel_on,XtCLabel_on,XtRString,sizeof(((WswitchRec*)NULL)->wswitch.label_on),XtOffsetOf(WswitchRec,wswitch.label_on),XtRString,(XtPointer)"dummy"},
#line 10 "Wswitch.widget"
{XtNsizex,XtCSizex,XtRDistance,sizeof(((WswitchRec*)NULL)->wswitch.sizex),XtOffsetOf(WswitchRec,wswitch.sizex),XtRString,(XtPointer)"0"},
#line 11 "Wswitch.widget"
{XtNkey_svar,XtCKey_svar,XtRInt,sizeof(((WswitchRec*)NULL)->wswitch.key_svar),XtOffsetOf(WswitchRec,wswitch.key_svar),XtRImmediate,(XtPointer)0 },
#line 12 "Wswitch.widget"
{XtNact,XtCAct,XtRInt,sizeof(((WswitchRec*)NULL)->wswitch.act),XtOffsetOf(WswitchRec,wswitch.act),XtRImmediate,(XtPointer)0 },
};

WswitchClassRec wswitchClassRec = {
{ /* core_class part */
/* superclass   	*/  (WidgetClass) &wlabelClassRec,
/* class_name   	*/  "Wswitch",
/* widget_size  	*/  sizeof(WswitchRec),
/* class_initialize 	*/  NULL,
/* class_part_initialize*/  _resolve_inheritance,
/* class_inited 	*/  FALSE,
/* initialize   	*/  initialize,
/* initialize_hook 	*/  NULL,
/* realize      	*/  XtInheritRealize,
/* actions      	*/  actionsList,
/* num_actions  	*/  6,
/* resources    	*/  resources,
/* num_resources 	*/  7,
/* xrm_class    	*/  NULLQUARK,
/* compres_motion 	*/  False ,
/* compress_exposure 	*/  TRUE ,
/* compress_enterleave 	*/  False ,
/* visible_interest 	*/  False ,
/* destroy      	*/  NULL,
/* resize       	*/  XtInheritResize,
/* expose       	*/  XtInheritExpose,
/* set_values   	*/  NULL,
/* set_values_hook 	*/  NULL,
/* set_values_almost 	*/  XtInheritSetValuesAlmost,
/* get_values+hook 	*/  NULL,
/* accept_focus 	*/  XtInheritAcceptFocus,
/* version      	*/  XtVersion,
/* callback_private 	*/  NULL,
/* tm_table      	*/  defaultTranslations,
/* query_geometry 	*/  query_geometry,
/* display_acceleator 	*/  XtInheritDisplayAccelerator,
/* extension    	*/  NULL 
},
{ /* Wheel_class part */
exec_command,
XtInherit_sig_recv,
},
{ /* Wlabel_class part */
XtInherit_cache_hit,
},
{ /* Wswitch_class part */
 /* dummy */  0
},
};
WidgetClass wswitchWidgetClass = (WidgetClass) &wswitchClassRec;
/*ARGSUSED*/
#line 64 "Wswitch.widget"
static void activate(self,event,params,num_params)Widget self;XEvent*event;String*params;Cardinal*num_params;
{
  	if( ((WswitchWidget)self)->wswitch.act == 1 ) return; 
	((WswitchWidget)self)->wswitch.act = 1;
  	((WswitchWidget)self)->wheel.state = STATE_ARMED;
	((WswitchWidget)self)->wlabel.label = ((WswitchWidget)self)->wswitch.label_on;
  	((WswitchWidgetClass)self->core.widget_class)->core_class.expose(self,NULL,NULL);
}

/*ARGSUSED*/
#line 73 "Wswitch.widget"
static void deactivate(self,event,params,num_params)Widget self;XEvent*event;String*params;Cardinal*num_params;
{
  	if( ((WswitchWidget)self)->wswitch.act == 0 ) return; 
	((WswitchWidget)self)->wswitch.act = 0;
  	((WswitchWidget)self)->wheel.state = STATE_NORMAL;
	((WswitchWidget)self)->wlabel.label = ((WswitchWidget)self)->wswitch.label_off;
  	((WswitchWidgetClass)self->core.widget_class)->core_class.expose(self,NULL,NULL);
}

/*ARGSUSED*/
#line 82 "Wswitch.widget"
static void highlight(self,event,params,num_params)Widget self;XEvent*event;String*params;Cardinal*num_params;
{
  if( ((WswitchWidget)self)->wheel.state == STATE_SELECTED ) return;
  ((WswitchWidget)self)->wheel.state = STATE_SELECTED;
  ((WswitchWidgetClass)self->core.widget_class)->core_class.expose(self,NULL,NULL);
}

/*ARGSUSED*/
#line 89 "Wswitch.widget"
static void reset(self,event,params,num_params)Widget self;XEvent*event;String*params;Cardinal*num_params;
{
  if( ((WswitchWidget)self)->wheel.state == STATE_NORMAL ) return;
  ((WswitchWidget)self)->wheel.state = ((WswitchWidget)self)->wswitch.act ? STATE_ARMED : STATE_NORMAL;
  ((WswitchWidgetClass)self->core.widget_class)->core_class.expose(self,NULL,NULL);
}

/*ARGSUSED*/
#line 96 "Wswitch.widget"
static void toggle(self,event,params,num_params)Widget self;XEvent*event;String*params;Cardinal*num_params;
{
	if( ((WswitchWidget)self)->wswitch.act ) deactivate(self,0,0,0);
	else activate(self,0,0,0);
}

/*ARGSUSED*/
#line 102 "Wswitch.widget"
static void notify(self,event,params,num_params)Widget self;XEvent*event;String*params;Cardinal*num_params;
{
	toggle(self,0,0,0);	
	init_svar(self);
	svar_write_callbacks(((WswitchWidget)self)->wswitch.key_svar);
	XtCallCallbackList( self, ((WswitchWidget)self)->wheel.callback, event );
}

static void _resolve_inheritance(class)
WidgetClass class;
{
  WswitchWidgetClass c __attribute__((unused)) = (WswitchWidgetClass) class;
  WswitchWidgetClass super __attribute__((unused));
  if (class == wswitchWidgetClass) return;
  super = (WswitchWidgetClass)class->core_class.superclass;
}
#line 19 "Wswitch.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 19 "Wswitch.widget"
static void initialize(Widget  request,Widget self,ArgList  args,Cardinal * num_args)
#else
#line 19 "Wswitch.widget"
static void initialize(request,self,args,num_args)Widget  request;Widget self;ArgList  args;Cardinal * num_args;
#endif
#line 20 "Wswitch.widget"
{
        TRACE(2,"Wbutton:%s focus group: %s", ((WswitchWidget)self)->core.name, ((WswitchWidget)self)->wheel.focus_group );
	((WswitchWidget)self)->wlabel.label = ((WswitchWidget)self)->wswitch.label_off;
	if( ((WswitchWidget)self)->wswitch.act ) {
	    ((WswitchWidget)self)->wheel.state = STATE_ARMED;
	    ((WswitchWidget)self)->wlabel.label = ((WswitchWidget)self)->wswitch.label_on;
	}
	else ((WswitchWidget)self)->wlabel.label = ((WswitchWidget)self)->wswitch.label_off;
	init_svar(self);
}
#line 31 "Wswitch.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 31 "Wswitch.widget"
static int  exec_command(Widget self,int  cmd,int  val)
#else
#line 31 "Wswitch.widget"
static int  exec_command(self,cmd,val)Widget self;int  cmd;int  val;
#endif
#line 32 "Wswitch.widget"
{
  Cardinal null;
  if( cmd == WHEEL_FIRE ) {
    if( ((WswitchWidget)self)->wheel.state == STATE_SELECTED ) { notify(self, NULL,NULL, &null ); return 1; }
  }
  
  return 0;
}
#line 42 "Wswitch.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 42 "Wswitch.widget"
static XtGeometryResult  query_geometry(Widget self,XtWidgetGeometry * request,XtWidgetGeometry * reply)
#else
#line 42 "Wswitch.widget"
static XtGeometryResult  query_geometry(self,request,reply)Widget self;XtWidgetGeometry * request;XtWidgetGeometry * reply;
#endif
#line 43 "Wswitch.widget"
{
    int w,h;
    char *s = strlen(((WswitchWidget)self)->wswitch.label_on) > strlen(((WswitchWidget)self)->wswitch.label_off) ? ((WswitchWidget)self)->wswitch.label_on : ((WswitchWidget)self)->wswitch.label_off;
    calculate_label_size(self, s, &w, &h );  
    reply->request_mode = CWX | CWY | CWWidth | CWHeight;
    reply->x=0; reply->y=0;
    reply->width =  w;
    reply->height = h;
    TRACE(2, "%s: our prefered size is %dx%d", XtName(self),
                  w,h );
    return XtGeometryAlmost;
}
