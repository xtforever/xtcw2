/* Generated by wbuild
 * (generator version 3.3)
 */
#include <X11/IntrinsicP.h>
#include <X11/StringDefs.h>
#line 177 "VBox.widget"
#include "converters.h"
#line 178 "VBox.widget"
#include "mls.h"
#include <xtcw/VBoxP.h>
static void _resolve_inheritance(
#if NeedFunctionPrototypes
WidgetClass
#endif
);
#line 26 "VBox.widget"
static void initialize(
#if NeedFunctionPrototypes
Widget ,Widget,ArgList ,Cardinal *
#endif
);
#line 32 "VBox.widget"
static void resize(
#if NeedFunctionPrototypes
Widget
#endif
);
#line 39 "VBox.widget"
static void change_managed(
#if NeedFunctionPrototypes
Widget
#endif
);
#line 68 "VBox.widget"
static XtGeometryResult  query_geometry(
#if NeedFunctionPrototypes
Widget,XtWidgetGeometry *,XtWidgetGeometry *
#endif
);
#line 93 "VBox.widget"
static XtGeometryResult  geometry_manager(
#if NeedFunctionPrototypes
Widget ,XtWidgetGeometry *,XtWidgetGeometry *
#endif
);
#line 114 "VBox.widget"
static void expose(
#if NeedFunctionPrototypes
Widget,XEvent *,Region 
#endif
);
#line 124 "VBox.widget"
static void calculate_size(
#if NeedFunctionPrototypes
Widget
#endif
);
#line 152 "VBox.widget"
static void do_layout(
#if NeedFunctionPrototypes
Widget
#endif
);
#line 124 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 124 "VBox.widget"
static void calculate_size(Widget self)
#else
#line 124 "VBox.widget"
static void calculate_size(self)Widget self;
#endif
#line 125 "VBox.widget"
{
    int i,w,h, max_w, max_h;
    XtWidgetGeometry reply;
    Widget child;

    max_w = max_h = 0;

    if( ((VBoxWidget)self)->composite.num_children == 0 ) return;

    for (i = 0; i < ((VBoxWidget)self)->composite.num_children; i++) {
	child = ((VBoxWidget)self)->composite.children[i];
	(void) XtQueryGeometry(child, NULL, &reply);
        w = reply.width + reply.border_width * 2;
        h = reply.height+ reply.border_width * 2;

        if(DB) printf("%s: %s Child: %s size: %u %u\n", XtName(self), __func__, XtName(child), w, h );

        if( max_w < w ) max_w = w;
        if( max_h < h ) max_h = h;
    }

    ((VBoxWidget)self)->vBox.total_width = max_w;
    ((VBoxWidget)self)->vBox.total_height = (((VBoxWidget)self)->composite.num_children - 1) * ((VBoxWidget)self)->vBox.vgap + max_h * ((VBoxWidget)self)->composite.num_children;

    TRACE(2,"%s: %s %dx%d gap=%d\n",__func__, ((VBoxWidget)self)->core.name, ((VBoxWidget)self)->vBox.total_width, ((VBoxWidget)self)->vBox.total_height, ((VBoxWidget)self)->vBox.vgap );
}
#line 152 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 152 "VBox.widget"
static void do_layout(Widget self)
#else
#line 152 "VBox.widget"
static void do_layout(self)Widget self;
#endif
#line 153 "VBox.widget"
{
    int i,b;
    Widget child;
    Dimension y;
    float height;

    if( ((VBoxWidget)self)->composite.num_children == 0 ) return;

    height =  ((VBoxWidget)self)->core.height - (((VBoxWidget)self)->composite.num_children - 1) * ((VBoxWidget)self)->vBox.vgap;
    height /= ((VBoxWidget)self)->composite.num_children;

    if(DB) printf("%s: %s child size: %f %u\n", XtName(self), __func__, ((VBoxWidget)self)->core.width, height);

    y=0;
    for (i = 0; i < ((VBoxWidget)self)->composite.num_children; i++) {
	child = ((VBoxWidget)self)->composite.children[i];
        b=((VBoxWidget)child)->core.border_width;
	XtConfigureWidget(child, 0, y, ((VBoxWidget)self)->core.width - 2 *b,
			  height - 2*b, b );
        y += height + ((VBoxWidget)self)->vBox.vgap;
    }
}

static XtResource resources[] = {
#line 18 "VBox.widget"
{XtNvgap,XtCVgap,XtRDistance,sizeof(((VBoxRec*)NULL)->vBox.vgap),XtOffsetOf(VBoxRec,vBox.vgap),XtRString,(XtPointer)"2mm"},
};

VBoxClassRec vBoxClassRec = {
{ /* core_class part */
/* superclass   	*/  (WidgetClass) &compositeClassRec,
/* class_name   	*/  "VBox",
/* widget_size  	*/  sizeof(VBoxRec),
/* class_initialize 	*/  NULL,
/* class_part_initialize*/  _resolve_inheritance,
/* class_inited 	*/  FALSE,
/* initialize   	*/  initialize,
/* initialize_hook 	*/  NULL,
/* realize      	*/  XtInheritRealize,
/* actions      	*/  NULL,
/* num_actions  	*/  0,
/* resources    	*/  resources,
/* num_resources 	*/  1,
/* xrm_class    	*/  NULLQUARK,
/* compres_motion 	*/  False ,
/* compress_exposure 	*/  FALSE ,
/* compress_enterleave 	*/  False ,
/* visible_interest 	*/  False ,
/* destroy      	*/  NULL,
/* resize       	*/  resize,
/* expose       	*/  expose,
/* set_values   	*/  NULL,
/* set_values_hook 	*/  NULL,
/* set_values_almost 	*/  XtInheritSetValuesAlmost,
/* get_values+hook 	*/  NULL,
/* accept_focus 	*/  XtInheritAcceptFocus,
/* version      	*/  XtVersion,
/* callback_private 	*/  NULL,
/* tm_table      	*/  NULL,
/* query_geometry 	*/  query_geometry,
/* display_acceleator 	*/  XtInheritDisplayAccelerator,
/* extension    	*/  NULL 
},
{ /* composite_class part */
geometry_manager,
change_managed,
XtInheritInsertChild,
XtInheritDeleteChild,
NULL
},
{ /* VBox_class part */
 /* dummy */  0
},
};
WidgetClass vBoxWidgetClass = (WidgetClass) &vBoxClassRec;
static void _resolve_inheritance(class)
WidgetClass class;
{
  VBoxWidgetClass c __attribute__((unused)) = (VBoxWidgetClass) class;
  VBoxWidgetClass super __attribute__((unused));
  static CompositeClassExtensionRec extension_rec = {
    NULL, NULLQUARK, XtCompositeExtensionVersion,
    sizeof(CompositeClassExtensionRec), True};
  CompositeClassExtensionRec *ext;
  ext = (XtPointer)XtMalloc(sizeof(*ext));
  *ext = extension_rec;
  ext->next_extension = c->composite_class.extension;
  c->composite_class.extension = ext;
  if (class == vBoxWidgetClass) return;
  super = (VBoxWidgetClass)class->core_class.superclass;
}
#line 26 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 26 "VBox.widget"
static void initialize(Widget  request,Widget self,ArgList  args,Cardinal * num_args)
#else
#line 26 "VBox.widget"
static void initialize(request,self,args,num_args)Widget  request;Widget self;ArgList  args;Cardinal * num_args;
#endif
#line 27 "VBox.widget"
{
        if( ! ((VBoxWidget)self)->core.width ) ((VBoxWidget)self)->core.width=10;
        if( ! ((VBoxWidget)self)->core.height ) ((VBoxWidget)self)->core.height = 10;
}
#line 32 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 32 "VBox.widget"
static void resize(Widget self)
#else
#line 32 "VBox.widget"
static void resize(self)Widget self;
#endif
#line 33 "VBox.widget"
{
        TRACE(2, "HBOX %s: %dx%d\n", XtName(self),
                   ((VBoxWidget)self)->core.width, ((VBoxWidget)self)->core.height );
        do_layout(self);
}
#line 39 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 39 "VBox.widget"
static void change_managed(Widget self)
#else
#line 39 "VBox.widget"
static void change_managed(self)Widget self;
#endif
#line 40 "VBox.widget"
{
        XtWidgetGeometry request, reply;
        XtGeometryResult result;
        if (((VBoxWidget)self)->composite.num_children == 0) return;

        calculate_size(self);
        if(DB) printf("%s: %s size prefered: %u %u\n", XtName(self), __func__, ((VBoxWidget)self)->vBox.total_width, ((VBoxWidget)self)->vBox.total_height );

        request.request_mode = CWWidth | CWHeight;
        request.width =  ((VBoxWidget)self)->vBox.total_width;
        request.height = ((VBoxWidget)self)->vBox.total_height;
        XtMakeGeometryRequest(self, &request, &reply);
        if(DB) printf("%s: %s size granted: %u %u\n", XtName(self), __func__, ((VBoxWidget)self)->core.width, ((VBoxWidget)self)->core.height );
        ((VBoxWidget)self)->vBox.total_width = ((VBoxWidget)self)->core.width; ((VBoxWidget)self)->vBox.total_height = ((VBoxWidget)self)->core.height;
        do_layout(self);
}
#line 68 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 68 "VBox.widget"
static XtGeometryResult  query_geometry(Widget self,XtWidgetGeometry * request,XtWidgetGeometry * reply)
#else
#line 68 "VBox.widget"
static XtGeometryResult  query_geometry(self,request,reply)Widget self;XtWidgetGeometry * request;XtWidgetGeometry * reply;
#endif
#line 69 "VBox.widget"
{
        /* every proposed geometry is fine */
    if (((VBoxWidget)self)->composite.num_children == 0) return XtGeometryYes;

    reply->request_mode = CWX | CWY | CWWidth | CWHeight;
    calculate_size(self);
    reply->x=0; reply->y=0;
    reply->width =  ((VBoxWidget)self)->vBox.total_width;
    reply->height = ((VBoxWidget)self)->vBox.total_height;

    TRACE(2, "%s: parent request is: %dx%d", XtName(self),
             request->width,
             request->width );

    TRACE(2, "%s: our prefered size is %dx%d", XtName(self),
                  ((VBoxWidget)self)->vBox.total_width,
                  ((VBoxWidget)self)->vBox.total_height );
    return XtGeometryAlmost;
}
#line 93 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 188 "VBox.widget"
static XtGeometryResult  geometry_manager(Widget  child,XtWidgetGeometry * request,XtWidgetGeometry * reply)
#else
#line 188 "VBox.widget"
static XtGeometryResult  geometry_manager(child,request,reply)Widget  child;XtWidgetGeometry * request;XtWidgetGeometry * reply;
#endif
{ Widget self = XtParent(child); {
    /* Widget $ = XtParent(child); automatically inserted by wbuild */
    Dimension wd, ht, bw;
    Position x, y;

    /* Get complete geometry, from request or current value */
    x = request->request_mode & CWX ? request->x : ((VBoxWidget)child)->core.x;
    y = request->request_mode & CWY ? request->y : ((VBoxWidget)child)->core.y;
    wd = request->request_mode & CWWidth ? request->width : ((VBoxWidget)child)->core.width;
    ht = request->request_mode & CWHeight ? request->height : ((VBoxWidget)child)->core.height;
    bw = request->request_mode & CWBorderWidth ? request->border_width
	: ((VBoxWidget)child)->core.border_width;

    if(DB) printf("%s: %s Child: %s wanted size: %u %u\n", XtName(self), __func__, XtName(child), wd, ht );

    XtConfigureWidget(child, x, y, wd, ht, bw);
    return XtGeometryDone;
}
}
#line 114 "VBox.widget"
/*ARGSUSED*/
#if NeedFunctionPrototypes
#line 114 "VBox.widget"
static void expose(Widget self,XEvent * event,Region  region)
#else
#line 114 "VBox.widget"
static void expose(self,event,region)Widget self;XEvent * event;Region  region;
#endif
#line 115 "VBox.widget"
{
        if(DB) printf("%s: %s size: %u %u\n", XtName(self), __func__, ((VBoxWidget)self)->core.width, ((VBoxWidget)self)->core.height );
}
